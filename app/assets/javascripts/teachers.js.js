// Generated by CoffeeScript 1.9.3
var getCounties, teachersInfoReady;

teachersInfoReady = function() {
  var bestPictures, counties, countyList, dropzone, error, h;
  $.cookieBar({
    declineButton: true
  });
  if (!(jQuery.cookieBar('cookies'))) {
    $('#share_buttons').empty();
    $('#share_buttons').hide();
    $('#mobile_share_buttons').empty();
    $('#mobile_share_buttons').hide();
  }
  $(document).on('click', '.share_buttons_close', function() {
    return $('#share_buttons').hide();
  });
  $('#qualification_present').on('click', function() {
    if ($("#qualification_endDate").css('opacity') === '1') {
      $('#qualification_endDate').animate({
        opacity: .1
      });
      return $('#qualification_endDate').children().prop({
        disabled: true
      });
    } else {
      $('#qualification_endDate').animate({
        opacity: 1
      });
      return $('#qualification_endDate').children().prop({
        disabled: false
      });
    }
  });
  $('#qual_left').css('height', $('#qual_form').height());
  if ($('#dropzone').length) {
    try {
      dropzone = new Dropzone('#dropzone', {
        paramName: "photo[avatar]",
        addRemoveLinks: true,
        parallelUploads: 10,
        thumbnailWidth: 150,
        thumbnailHeight: 180,
        autoProcessQueue: false
      });
      dropzone.on('error', function(file) {
        return $('body').prepend("<b style='color: red;'>An error occurred while saving the Student.</b>");
      });
      dropzone.on('sending', function(file, xhr, formData) {
        return formData.append('profile', 'true');
      });
      dropzone.on('success', function(file) {
        return location.reload();
      });
      $('#process_queue').on('click', function() {
        return dropzone.processQueue();
      });
      $('.popover-dismiss').popover({
        trigger: 'focus'
      });
    } catch (_error) {
      error = _error;
    }
  }
  $('#visible_check').on('click', function() {
    if ($('#endDate').css('opacity') === '1') {
      return $('#endDate').animate({
        opacity: .1
      });
    } else {
      return $('#endDate').animate({
        opacity: 1
      });
    }
  });
  if ($('.typeahead.subject').length) {
    $('#main_subject_search').on('keypress', function(e) {
      if (e.which === 13) {
        return e.preventDefault();
      }
    });
    bestPictures = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace("name"),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      prefetch: {
        url: "/subject-search",
        ttl: 3600000
      }
    });
    bestPictures.clearPrefetchCache();
    bestPictures.initialize();
    $(".typeahead.subject").typeahead({
      hint: true,
      highlight: true,
      minLength: 2
    }, {
      name: "Subjects",
      displayKey: "name",
      source: bestPictures.ttAdapter()
    });
  }
  if ($('.typeahead.county').length) {
    countyList = getCounties();
    counties = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace("value"),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(getCounties(), function(county) {
        return {
          value: county
        };
      })
    });
    counties.initialize();
    $(".typeahead.county").typeahead({
      hint: true,
      highlight: true,
      minLength: 1
    }, {
      name: "counties",
      displayKey: "value",
      source: counties.ttAdapter()
    });
  }
  if ($('.review_lesson').length) {
    $('.review_lesson_input').rating({
      filled: "glyphicon glyphicon-thumbs-up",
      empty: "glyphicon glyphicon-thumbs-down"
    });
    $('.review_lesson_input').on('change', function() {
      var rating;
      rating = parseInt($(this).val()) + 1;
      $('.rating_value').text(rating + " thumbs up");
      return $(this).closest('.review_lesson').append("<input name=\"review[rating]\" type=\"hidden\" value=\"" + rating + "\">");
    });
  }
  $(document).on('change', '.form-control.distance_rate', function() {
    return $('#main_subject_search').submit();
  });
  $('#subject_search').keyup(function() {
    return $.get($('#subject_search').attr('action'), $('#subject_search').serialize(), null, 'script');
  });
  if ($('#login_modal_email').length) {
    $('#login_modal').on('shown.bs.modal', function() {
      return document.getElementById('login_modal_email').focus();
    });
  }
  if ($('#teachers_subjects_modal').length) {
    $('#teachers_subjects_modal').on('shown.bs.modal', function() {
      return document.getElementById('teachers_search_input').focus();
    });
  }
  if ($('.search_results_row').length) {
    $('.search_results_row').mouseover(function() {
      $('.image_container').css('color', 'black');
      $(this).find('.search_results_teachers_name').animate({
        color: '#509BE6'
      }, 50);
      $('.image_container').css('text-decoration', 'none');
      return $(this).find('.results_photos.back').animate({
        opacity: .5
      }, 50);
    });
    $('.search_results_row').mouseleave(function() {
      $('.image_container').css('color', 'black');
      $(this).find('.search_results_teachers_name').animate({
        color: 'black'
      }, 50);
      return $(this).find('.results_photos.back').animate({
        opacity: 0
      }, 50);
    });
  }
  if ($(".stock_photos_container").length) {
    h = $('#main_page').height();
    $('#main_page').height(h);
    $(document).on('click', '.browse_option', function(e) {
      $('.browse_option').removeClass('btn btn-success');
      $(this).addClass('btn btn-success');
      e.preventDefault();
      return $.ajax({
        url: 'refresh-welcome',
        data: {
          page: $(this).attr('id')
        },
        type: 'get',
        success: function(html) {
          $('.fav_subjects_container').empty();
          return $(html).appendTo('.fav_subjects_container').show('slow');
        }
      });
    });
    $('.stock_photo_container').mouseover(function() {
      return $(this).find('.welcome_subject_image').animate({
        opacity: .7
      }, 50);
    });
    $('.stock_photo_container').mouseleave(function() {
      return $(this).find('.welcome_subject_image').animate({
        opacity: 0
      }, 50);
    });
  }
  if ($('.profile_pic_popover').length) {
    $("html").click(function(e) {
      return $(".profile_pic_popover").popover("hide");
    });
    $(".profile_pic_popover").popover({
      html: true,
      trigger: "manual"
    }).click(function(e) {
      $('.profile_pic_popover').not(this).popover('hide');
      $(this).popover("toggle");
      return e.stopPropagation();
    });
  }
  if ($('.btn_book_now').length) {
    if ((gon.teacher_id != null)) {
      if ((window.ga != null)) {
        ga('create', 'UA-57834504-3', 'auto');
      }
    }
    $(document).on('change', '#Multiple', function() {
      return $('#no_of_weeks').animate({
        height: 'toggle'
      }, 100);
    });
    $(document).on('submit', '#create_event_form', function(e) {
      e.preventDefault();
      if ($('#no_of_weeks').val() === '' && $('#Multiple').prop('checked')) {
        return $('#no_of_weeks').addClass('select_error');
      } else {
        return $.post($(this).attr('action'), $(this).serialize());
      }
    });
    (function() {
      var img, w;
      img = new Image();
      img.src = gon.profile_pic_url;
      w = $('.show_teacher_profile_section').outerWidth();
      $('.profile_pic_container').css('height', w);
      return $('.profile_pic_container').css('width', w);
    })();
    $(window).resize(function() {
      var w;
      w = $('.show_teacher_profile_section').outerWidth();
      $('.profile_pic_container').css('height', w);
      return $('.profile_pic_container').css('width', w);
    });
    $('.fotorama').fotorama({
      width: 333,
      transition: "crossfade",
      loop: true,
      autoplay: true,
      nav: "thumbs",
      allowfullscreen: true,
      height: 333,
      arrows: true,
      fit: 'cover',
      thumbfit: 'cover'
    });
    $("a[data-toggle=\"tab\"]").on("shown.bs.tab", function(e) {
      return $('#address').empty().append(gon.locations[$(this).data('index')].address);
    });
    if ($('#location_choice').length) {
      document.getElementById("location_choice").selectedIndex = 0;
    }
    $('#location_choice').on('change', function() {
      if (this.value === 'Teachers house') {
        $('.select_teachers_location').css('display', 'inline');
        return $('.select_home_lesson').css('display', 'none');
      } else {
        $('.select_teachers_location').css('display', 'none');
        return $('.select_home_lesson').css('display', 'inline');
      }
    });
    if ($('#the_one_modal').length) {
      $('#the_one_modal').on('hidden.bs.modal', function() {
        $('.payment_form_container').empty();
        $('.display_teachers_location').empty();
        $('.returned_locations_container').empty();
        return $('.payment_choice_error').empty();
      });
      $('#the_one_modal').on('shown.bs.modal', function() {
        $('.payment_form_container').empty();
        return $("select").each(function() {
          return $(this).val($(this).find('option[selected]').val());
        });
      });
      $(document).on('change', '.select_subject', function() {
        return $('.select_subject').submit();
      });
      $(document).on('change', '.select_home_or_location', function() {
        $('.location_choice').val($('.select_home_or_location').val());
        $('.subject_id').val($('.select_subject').val());
        return $('.get_subjects_form').submit();
      });
      $(document).on('change', '.teachers_location_selection', function() {
        $('.teachers_locations_subject').val($('.select_subject').val());
        return $('.get_locations_price_form').submit();
      });
    }
    $(document).on('submit', '.home_booking_form', function(e) {
      var address;
      e.preventDefault();
      address = null;
      $('.home_address').val($('#home_booking_address').val());
      if ($('#remember').is(':checked')) {
        $('.save_address').val('true');
      } else {
        $('.save_address').val('false');
      }
      address = $('#home_booking_address').val();
      if (!address) {
        return alert("Address cannot be blank");
      } else {
        return this.submit();
      }
    });
    $(document).on('click', '.stripe-button-el', function() {
      $('.home_address').val($('#home_booking_address').val());
      if ($('#remember').is(':checked')) {
        return $('.save_address').val('true');
      } else {
        return $('.save_address').val('false');
      }
    });
    $('#payment_packages_modal').on('shown.bs.modal', function() {
      return $('.package_booking_form').append("<input type=\"hidden\" name=\"package_id\" class=\"package_id\" value=\"" + ($('.package_select_box').val()) + "\"> ");
    });
    $(document).on('change', '.package_select_box', function() {
      return $('.package_id').val($(this).val());
    });
  }
  if ('.previous_lessons_header'.length) {
    $("html").click(function(e) {
      return $(".review_hover").popover("hide");
    });
    $(".review_hover").popover({
      html: true,
      trigger: "manual",
      placement: 'left'
    }).click(function(e) {
      $('.review_hover').not(this).popover('hide');
      $(this).popover("toggle");
      return e.stopPropagation();
    });
  }
  if ($('.create_package_form')) {
    $('.create_package_form').submit(function(e) {
      var subject_name;
      e.preventDefault();
      subject_name = $('.package_subject_name :selected').text();
      $('.create_package_form').append("<input value=\"" + subject_name + "\" type=\"hidden\" name=\"package[subject_name]\">");
      return this.submit();
    });
  }
  if ($(".grind_form")) {
    return $(".grind_form").submit(function(e) {
      var subject_name;
      e.preventDefault();
      subject_name = $(".grind_subject_name :selected").text();
      $(".grind_form").append("<input value=\"" + subject_name + "\" type=\"hidden\" name=\"grind[subject_name]\">");
      return this.submit();
    });
  }
};

$(document).on('ready', teachersInfoReady);

$(document).on('page:load', teachersInfoReady);

$(window).unload(teachersInfoReady);

getCounties = function() {
  return ['Antrim', 'Armagh', 'Carlow', 'Cavan', 'Clare', 'Cork', 'Derry', 'Donegal', 'Down', 'Dublin', 'Fermanagh', 'Galway', 'Kerry', 'Kildare', 'Kilkenny', 'Laois', 'Leitrim', 'Limerick', 'Longford', 'Louth', 'Mayo', 'Meath', 'Monaghan', 'Offaly', 'Roscommon', 'Sligo', 'Tipperary', 'Tyrone', 'Waterford', 'Westmeath', 'Wexford', 'Wicklow'];
};
