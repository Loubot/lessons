// Generated by CoffeeScript 1.10.0
var getCounties, initFlashPLay, initFlashPublish, teachersInfoReady;

teachersInfoReady = function() {
  var bestPictures, counties, countyList, dropzone, error, error1, h;
  $.cookieBar({
    declineButton: true
  });
  if (!(jQuery.cookieBar('cookies'))) {
    $('#share_buttons').empty();
    $('#share_buttons').hide();
    $('#mobile_share_buttons').empty();
    $('#mobile_share_buttons').hide();
  }
  $(document).on('click', '.share_buttons_close', function() {
    return $('#share_buttons').hide();
  });
  $('#qualification_present').on('click', function() {
    if ($("#qualification_endDate").css('opacity') === '1') {
      $('#qualification_endDate').animate({
        opacity: .1
      });
      return $('#qualification_endDate').children().prop({
        disabled: true
      });
    } else {
      $('#qualification_endDate').animate({
        opacity: 1
      });
      return $('#qualification_endDate').children().prop({
        disabled: false
      });
    }
  });
  $('#qual_left').css('height', $('#qual_form').height());
  if ($('#dropzone').length) {
    try {
      dropzone = new Dropzone('#dropzone', {
        paramName: "photo[avatar]",
        addRemoveLinks: true,
        parallelUploads: 10,
        thumbnailWidth: 150,
        thumbnailHeight: 180,
        autoProcessQueue: true
      });
      dropzone.on('error', function(file) {
        return $('body').prepend("<b style='color: red;'>An error occurred while saving the Student.</b>");
      });
      dropzone.on('sending', function(file, xhr, formData) {
        return formData.append('profile', 'true');
      });
      dropzone.on('success', function(file) {
        return location.reload();
      });
      $('#process_queue').on('click', function() {
        return dropzone.processQueue();
      });
      $('.popover-dismiss').popover({
        trigger: 'focus'
      });
    } catch (error1) {
      error = error1;
    }
  }
  $('#mobile_pic_upload').on('click', function() {
    return $('#mobile_pic_form').submit();
  });
  $('#visible_check').on('click', function() {
    if ($('#endDate').css('opacity') === '1') {
      return $('#endDate').animate({
        opacity: .1
      });
    } else {
      return $('#endDate').animate({
        opacity: 1
      });
    }
  });
  if ($('.typeahead.subject').length) {
    $('#search_submit').on('keypress', function(f) {
      if (f.which === 13) {
        console.log("bb");
        return $('#main_subject_search').submit();
      }
    });
    $('#main_subject_search').on('keypress', function(e) {
      if (e.which === 13) {
        return e.preventDefault();
      }
    });
    bestPictures = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace("name"),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      prefetch: {
        url: "/subject-search",
        ttl: 3600000
      }
    });
    bestPictures.clearPrefetchCache();
    bestPictures.initialize();
    $(".typeahead.subject").typeahead({
      hint: true,
      highlight: true,
      minLength: 2
    }, {
      name: "Subjects",
      displayKey: "name",
      source: bestPictures.ttAdapter()
    });
  }
  if ($('.typeahead.county').length) {
    countyList = getCounties();
    counties = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace("value"),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: $.map(getCounties(), function(county) {
        return {
          value: county
        };
      })
    });
    counties.initialize();
    $(".typeahead.county").typeahead({
      hint: true,
      highlight: true,
      minLength: 1
    }, {
      name: "counties",
      displayKey: "value",
      source: counties.ttAdapter()
    });
  }
  if ($('.review_lesson').length) {
    $('.review_lesson_input').rating({
      filled: "glyphicon glyphicon-thumbs-up",
      empty: "glyphicon glyphicon-thumbs-down"
    });
    $('.review_lesson_input').on('change', function() {
      var rating;
      rating = parseInt($(this).val()) + 1;
      $('.rating_value').text(rating + " thumbs up");
      return $(this).closest('.review_lesson').append("<input name=\"review[rating]\" type=\"hidden\" value=\"" + rating + "\">");
    });
  }
  $(document).on('change', '.form-control.distance_rate', function() {
    return $('#main_subject_search').submit();
  });
  $('#teachers_subjects_modal').on('shown.bs.modal', function() {
    $('#search_results').empty();
    return $("#teachers_search_input").val('');
  });
  $('#subject_search').keyup(function() {
    if ($('#teachers_search_input').val().length > 1) {
      return $.get($('#subject_search').attr('action'), $('#subject_search').serialize(), null, 'script');
    }
  });
  if ($('#login_modal_email').length) {
    $('#login_modal').on('shown.bs.modal', function() {
      return document.getElementById('login_modal_email').focus();
    });
  }
  if ($('#teachers_subjects_modal').length) {
    $('#teachers_subjects_modal').on('shown.bs.modal', function() {
      return document.getElementById('teachers_search_input').focus();
    });
  }
  if ($('.search_results_row').length) {
    $('.search_results_row').mouseover(function() {
      $('.image_container').css('color', 'black');
      $(this).find('.search_results_teachers_name').animate({
        color: '#509BE6'
      }, 50);
      $('.image_container').css('text-decoration', 'none');
      return $(this).find('.results_photos.back').animate({
        opacity: .5
      }, 50);
    });
    $('.search_results_row').mouseleave(function() {
      $('.image_container').css('color', 'black');
      $(this).find('.search_results_teachers_name').animate({
        color: 'black'
      }, 50);
      return $(this).find('.results_photos.back').animate({
        opacity: 0
      }, 50);
    });
  }
  if ($(".stock_photos_container").length) {
    h = $('#main_page').height();
    $('#main_page').height(h);
    $(document).on('click', '.browse_option', function(e) {
      $('.browse_option').removeClass('btn btn-success');
      $(this).addClass('btn btn-success');
      e.preventDefault();
      return $.ajax({
        url: 'refresh-welcome',
        data: {
          page: $(this).attr('id')
        },
        type: 'get',
        success: function(html) {
          $('.fav_subjects_container').empty();
          return $(html).appendTo('.fav_subjects_container').show('slow');
        }
      });
    });
    $('.stock_photo_container').mouseover(function() {
      return $(this).find('.welcome_subject_image').animate({
        opacity: .7
      }, 50);
    });
    $('.stock_photo_container').mouseleave(function() {
      return $(this).find('.welcome_subject_image').animate({
        opacity: 0
      }, 50);
    });
  }
  if ($('.profile_pic_popover').length) {
    $("html").click(function(e) {
      return $(".profile_pic_popover").popover("hide");
    });
    $(".profile_pic_popover").popover({
      html: true,
      trigger: "manual"
    }).click(function(e) {
      $('.profile_pic_popover').not(this).popover('hide');
      $(this).popover("toggle");
      return e.stopPropagation();
    });
  }
  if ($('.btn_book_now').length) {
    if ((gon.teacher_id != null)) {
      if ((window.ga != null)) {
        ga('create', 'UA-57834504-3', 'auto');
      }
    }
    $(document).on('change', '#Multiple', function() {
      return $('#no_of_weeks').animate({
        height: 'toggle'
      }, 100);
    });
    $(document).on('submit', '#create_event_form', function(e) {
      e.preventDefault();
      if ($('#no_of_weeks').val() === '' && $('#Multiple').prop('checked')) {
        return $('#no_of_weeks').addClass('select_error');
      } else {
        return $.post($(this).attr('action'), $(this).serialize());
      }
    });
    (function() {
      var img, w;
      img = new Image();
      img.src = gon.profile_pic_url;
      w = $('.show_teacher_profile_section').outerWidth();
      $('.profile_pic_container').css('height', w);
      return $('.profile_pic_container').css('width', w);
    })();
    $(window).resize(function() {
      var w;
      w = $('.show_teacher_profile_section').outerWidth();
      $('.profile_pic_container').css('height', w);
      return $('.profile_pic_container').css('width', w);
    });
    $('.fotorama').fotorama({
      width: 333,
      transition: "crossfade",
      loop: true,
      autoplay: true,
      nav: "thumbs",
      allowfullscreen: true,
      height: 333,
      arrows: true,
      fit: 'cover',
      thumbfit: 'cover'
    });
    $("a[data-toggle=\"tab\"]").on("shown.bs.tab", function(e) {
      return $('#address').empty().append(gon.locations[$(this).data('index')].address);
    });
    if ($('#location_choice').length) {
      document.getElementById("location_choice").selectedIndex = 0;
    }
    $('#location_choice').on('change', function() {
      if (this.value === 'Teachers house') {
        $('.select_teachers_location').css('display', 'inline');
        return $('.select_home_lesson').css('display', 'none');
      } else {
        $('.select_teachers_location').css('display', 'none');
        return $('.select_home_lesson').css('display', 'inline');
      }
    });
    if ($('#the_one_modal').length) {
      AnyTime.noPicker('home_lesson_datepicker');
      $("#home_lesson_datepicker").AnyTime_picker({
        format: "%Y-%m-%d",
        placement: 'inline',
        hideInput: true
      });
      $('#the_one_modal').on('hidden.bs.modal', function() {
        $('.check_availabilty_form_container').html("");
        $('.location_only_price_select').css('display', 'none');
        $('.home_only_avail_times').css("display", 'none');
        $('.payment_choice_error').remove();
        return $("select").each(function() {
          return $(this).val($(this).find('option[selected]').val());
        });
      });
    }
    $(document).on('change', '.home_only_price_select', function() {
      if ($('.home_only_price_select')[0].selectedIndex !== 0) {
        return $('.home_only_avail_times').css('display', 'inline');
      }
    });
    $(document).on('change', '.location_only_select', function() {
      if ($('.location_only_select')[0].selectedIndex !== 0) {
        return $.post('/user_carts/1/loc-only-prices', {
          'user_cart[location_id]': $('.location_only_select').val(),
          'user_cart[teacher_id]': $('#user_cart_teacher_id').val(),
          'user_cart[subject_id': $('#user_cart_subject_id').val()
        }, 'script');
      }
    });
    $(document).on('change', '.select_home_or_location', function() {
      if ($('.home_or_location_select_tag')[0].selectedIndex !== 0) {
        return $('.select_home_or_location').submit();
      }
    });
    $(document).on('submit', '.home_booking_form', function(e) {
      var address;
      e.preventDefault();
      address = null;
      $('.home_address').val($('#home_booking_address').val());
      if ($('#hello_check_box').is(':checked')) {
        console.log('yes');
        $('.save_address').val("Remember address");
      } else {
        console.log('no');
        $('.save_address').val('false');
      }
      address = $('.home_address').val();
      if (!address) {
        return alert("Address cannot be blank");
      } else {
        return this.submit();
      }
    });
    $(document).on('click', '.stripe-button-el', function() {
      $('.home_address').val($('#home_booking_address').val());
      console.log($('.home_address').val());
      if ($('#hello_check_box').is(':checked')) {
        console.log('yes');
        return $('.home_booking_form').prepend(" <input type=\"hidden\" name=\"remember\" id=\"remember\" class=\"save_address\" value=\"Remember address\"> ");
      } else {
        console.log('no');
        return $('.save_address').val('false');
      }
    });
    $('#payment_packages_modal').on('shown.bs.modal', function() {
      return $('.package_booking_form').append("<input type=\"hidden\" name=\"package_id\" class=\"package_id\" value=\"" + ($('.package_select_box').val()) + "\"> ");
    });
    $(document).on('change', '.package_select_box', function() {
      return $('.package_id').val($(this).val());
    });
  }
  if ('.previous_lessons_header'.length) {
    $("html").click(function(e) {
      return $(".review_hover").popover("hide");
    });
    $(".review_hover").popover({
      html: true,
      trigger: "manual",
      placement: 'left'
    }).click(function(e) {
      $('.review_hover').not(this).popover('hide');
      $(this).popover("toggle");
      return e.stopPropagation();
    });
  }
  if ($('.create_package_form')) {
    $('.create_package_form').submit(function(e) {
      var subject_name;
      e.preventDefault();
      subject_name = $('.package_subject_name :selected').text();
      $('.create_package_form').append("<input value=\"" + subject_name + "\" type=\"hidden\" name=\"package[subject_name]\">");
      return this.submit();
    });
  }
  if ($(".grind_form")) {
    $(".grind_form").submit(function(e) {
      var subject_name;
      e.preventDefault();
      subject_name = $(".grind_subject_name :selected").text();
      $(".grind_form").append("<input value=\"" + subject_name + "\" type=\"hidden\" name=\"grind[subject_name]\">");
      return this.submit();
    });
  }
  if ($('.home_schooling')) {
    $('.show_home_schooling_content').on('click', function() {
      return $('.home_schooling_content').slideToggle('slow');
    });
    $('.show_location_schooling_content').on('click', function() {
      return $('.location_schooling_content').slideToggle('slow');
    });
    $('.show_maps_content').on('click', function() {
      return $('#map_container').slideToggle('slow', function() {
        return business_page_ready();
      });
    });
  }
  if ($('.teacher_edit_profile')) {
    $('.show_edit_teacher_info_content').on('click', function() {
      return $('.edit_teacher_info_content').slideToggle('slow');
    });
    $('.show_edit_teacher_subjects_content').on('click', function() {
      return $('.edit_teacher_subjects_content').slideToggle('slow');
    });
    $('.show_edit_teacher_photos_content').on('click', function() {
      return $('.edit_teacher_photos_content').slideToggle('slow');
    });
    $('.show_edit_teacher_experience_content').on('click', function() {
      return $('.edit_teacher_experience_content').slideToggle('slow');
    });
    $('.show_edit_teacher_bio_content').on('click', function() {
      return $('.edit_teacher_bio_content').slideToggle('slow');
    });
    return $('.show_edit_teacher_payment_content').on('click', function() {
      return $('.edit_teacher_payment_content').slideToggle('slow');
    });
  }
};

$(document).on('ready', teachersInfoReady);

$(document).on('page:load', teachersInfoReady);

$(window).unload(teachersInfoReady);

getCounties = function() {
  return ['Antrim', 'Armagh', 'Carlow', 'Cavan', 'Clare', 'Cork', 'Derry', 'Donegal', 'Down', 'Dublin', 'Fermanagh', 'Galway', 'Kerry', 'Kildare', 'Kilkenny', 'Laois', 'Leitrim', 'Limerick', 'Longford', 'Louth', 'Mayo', 'Meath', 'Monaghan', 'Offaly', 'Roscommon', 'Sligo', 'Tipperary', 'Tyrone', 'Waterford', 'Westmeath', 'Wexford', 'Wicklow'];
};

initFlashPublish = function() {
  var attributes, flashVars, params;
  flashVars = {
    'src': 'rtmp://46.101.155.142:1935/live_chat?publish=j',
    'controls': 'true'
  };
  params = {
    'quality': 'high',
    'bgcolor': '#000000',
    'allowFullScreen': 'true',
    'wmode': 'transparent',
    'allowScriptAccess': 'always',
    'src': 'rtmp://46.101.155.142:1935/live_chat?publish=j'
  };
  attributes = {
    'id': 'practice_audition_feed',
    'name': 'PracticeAudition'
  };
  return swfobject.embedSWF('VideoIO.swf', 'teachers_publish', '100%', '100%', '9', 'false', flashVars, params, attributes);
};

initFlashPLay = function() {
  var attributes, flashVars, params;
  flashVars = {
    'src': 'rtmp://46.101.155.142:1935/live_chat?play=l',
    'controls': 'true'
  };
  params = {
    'quality': 'high',
    'bgcolor': '#000000',
    'allowFullScreen': 'true',
    'wmode': 'transparent',
    'allowScriptAccess': 'always',
    'src': 'rtmp://46.101.155.142:1935/live_chat?play=l'
  };
  attributes = {
    'id': 'practice_audition_feed1',
    'name': 'PracticeAudition'
  };
  return swfobject.embedSWF('VideoIO.swf', 'students_play', '100%', '100%', '9', 'false', flashVars, params, attributes);
};
